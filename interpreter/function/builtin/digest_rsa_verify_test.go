// Code generated by __generator__/interpreter.go at once

package builtin

import (
	"encoding/base64"
	"testing"

	"github.com/ysugimoto/falco/interpreter/context"
	"github.com/ysugimoto/falco/interpreter/value"
)

// Fastly built-in function testing implementation of digest.rsa_verify
// Arguments may be:
// - ID, STRING, STRING, STRING, ID
// - ID, STRING, STRING, STRING
// Reference: https://developer.fastly.com/reference/vcl/functions/cryptographic/digest-rsa-verify/
func Test_Digest_rsa_verify(t *testing.T) {

	publicKey := "LS0tLS1CRUdJTiBQVUJMSUMgS0VZLS0tLS0KTUlJQ0lqQU5CZ2txaGtpRzl3MEJBUUVGQUFPQ0FnOEFNSUlDQ2dLQ0FnRUE1bGtPQUVZOE1CNnhoSmQxZVVCKwpvaGw0OVVWN2luWEFIRXZZZDcyUmJhcFgxNmVKK1IzT1l0aVAwYVVrYzhPdExZc2ZYTVlsMVNYU2c4bFNBRktpCkJVdmQxRFpJMVZObGN4QUVGdStESWFPNkEvQ2NiSWVybTIwek41UUNkZ2UzY1NuT1FWOHpOQmd4Sk5iM2IvVnoKREtwUkRLUGwxMldVb2l3SnVlL3Npc2hoaW1zaHhtOEk4NUFsSkYwamVIbXpMaHBLTUU2eVUwVzExTCt4dUFZUgpEKzJQV21uMWt4ODZhTU5QUE10OVZMS1NIK0MrQnNuTFhqK1BSMTRxdHV0Y3NWeTNRSHFzMVdoaDNPMTZHMWdHCi9ycWMvQjdrVW9GdWZFbHR5VkE3cGtQMzAwRG5TVDdLbmVVOTZ2RDh5NDMwYnZsSG1HSkMzRzF2T3crU3lpUzAKMENhVE9IWjdpWUIrb1lKZU5Qa0JzQUhobk16VGlaNEtuc2hDMnFLTnBNVlZuWWRUYW4yVER1SXd3elVsLys0ZgoxMHhyREhkZHdiQzFFa096N2d1dGRGNXZzMXdWcEdBRG9yL0VqVkdOSXhOem1vNzA1bU82WUR5OEJlOThnbTBHCkNSck5JVnFCYVpUWDEvbDRISHVyZzg2SCt5WjFxOWVRS3pLNGFFWmMzSFJhZXFZSTBnQ3FmSXRkQk5COHpjSGYKS0FOMDZhaFBpM0NmSDBZTlZFVm1ZUVlmdGZHR0x1d2M2T0VEOGsrT21qUVljclNiRG9pbmpmT3hweElKV0dNeQpyYW1TcmN1aWRUdGcycEd2RVcwVlBvMHltc01xZmJTQnFvajJNdCt0MmFZT2hPVnU3dm5qaGlHZlI0cTE3UGROCmdXc3dyMzZMUnBTdjV2OW1lVFUyeWw4Q0F3RUFBUT09Ci0tLS0tRU5EIFBVQkxJQyBLRVktLS0tLQo="
	pk, _ := base64.StdEncoding.DecodeString(publicKey)

	payload := "eyJhbGciOiJSUzUxMiIsInR5cCI6IkpXVCJ9.eyJrZXkiOiJrZXkxIiwicGF0aCI6Ii9yZXNwb25zZS1oZWFkZXJzKiIsInVpZCI6IjEyMzQ1Njc4OTAiLCJleHAiOjE3MjE2MzYzMTUsIm5hbWUiOiJKb2huIERvZSIsImdyb3VwcyI6InN1YnNjcmliZXJzIHVrIGV1IHRpZXItZ29sZCIsImFkbWluIjp0cnVlfQ"

	digest := "bFiqcDgUJrqPVmZ9eqyzMYOMCx6VFy--Ctxp-ANIRFJRJbgJIggSzL5NIUI89zQkqVughyiHVSjS0BEgPdCRHqCdXAmc05DZoJEWKlqNZ1wn0I-EuSx31orFzDlJRJ1MiXH3l3J2KCID2EJlQQjRYObLMgECiQT_MycSzVEFHV6xApY6LEenlG1zxux2bUrysSE3HaKRhCbttug76Br6lsicEN6zLZDueQD3qodu8RHgvXWKYYWGSzKxJYXaQcB31yl5ZP5hbdLhcWmc1aHw1HFQZr8TYGZEOxnTyiD1SmxPq7yvwvKAYSSYy_JS_lfgp3MOOLWAsHK0xpOKN6EOPAsuHsM8s3Ofi76OU5cXgKy4OtW4FVLnHWMZVASiFjjg6vLDTOUe7pmrZ4oNTNdoQ65DjbHqObAWXNrKMQZPLkrDzbLBm7dFSdE66PWSqdl10SqYR8iPmO0BxnkuCfgMmtQCcSqSTbb9wrbvO4ZKctJrxDsEH_BmLFowUHfrEY98tIX4BoKAFGr8JHtRna9lgWEbhHa5gN33RR-PFwUJbMzNVnRw2hkk183UgZC-5zytTgRK5Mp9gce_Oe-8Bc0GK1ssNpz931XXYzLPEBfGZJEMtvOcjmVr1OFjiHm_bR0OkH_zk4YUZFBrj_GwePxXQlvNEXLmT7w30YfCCO6ho8E"

	ret, err := Digest_rsa_verify(
		&context.Context{},
		&value.Ident{Value: "sha512"},
		&value.String{Value: string(pk)},
		&value.String{Value: payload},
		&value.String{Value: digest},
		&value.Ident{Value: "url"},
	)

	if err != nil {
		t.Errorf("Unexpected error: %s", err)
	}
	if ret.Type() != value.BooleanType {
		t.Errorf("Unexpected return type, expect=BOOL, got=%s", ret.Type())
	}
	v := value.Unwrap[*value.Boolean](ret)
	if v.Value != true {
		t.Errorf("return value unmatch, expect=true, got=%t", v.Value)
	}
}
